ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   1


PC     Object              I  Line    Source 
                           A     1    ; ZiLOG ZNEO ANSI C Compiler Release 1.11
                           A     2    ; -model=S -nomodsect -regvar -noreduceopt -debug -peephole
                           A     3    ; -localcse -optsize -const=ROM -alias -fastcall 
                           A     4    	FILE	"..\LED.C"
                           A     5    .debug "C"
                           A     6    	SEGMENT CODE
                           A     7    .begrec "NONAME0",8
                           A     8    .define "quot"
                           A     9    .value 0
                           A    10    .class 8
                           A    11    .type 5
                           A    12    .type 0
                           A    13    .endef
                           A    14    .define "rem"
                           A    15    .value 4
                           A    16    .class 8
                           A    17    .type 5
                           A    18    .type 0
                           A    19    .endef
                           A    20    .endrec "NONAME0"
                           A    21    .begrec "NONAME1",8
                           A    22    .define "quot"
                           A    23    .value 0
                           A    24    .class 8
                           A    25    .type 5
                           A    26    .type 0
                           A    27    .endef
                           A    28    .define "rem"
                           A    29    .value 4
                           A    30    .class 8
                           A    31    .type 5
                           A    32    .type 0
                           A    33    .endef
                           A    34    .endrec "NONAME1"
                           A    35    .begrec "fmt_type",16
                           A    36    .define "status"
                           A    37    .value 0
                           A    38    .class 8
                           A    39    .type 12
                           A    40    .type 0
                           A    41    .endef
                           A    42    .define "flags"
                           A    43    .value 1
                           A    44    .class 8
                           A    45    .type 12
                           A    46    .type 0
                           A    47    .endef
                           A    48    .define "size"
                           A    49    .value 2
                           A    50    .class 8
                           A    51    .type 12
                           A    52    .type 0
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   2


PC     Object              I  Line    Source led.src
                           A    53    .endef
                           A    54    .define "chr"
                           A    55    .value 3
                           A    56    .class 8
                           A    57    .type 12
                           A    58    .type 0
                           A    59    .endef
                           A    60    .define "type"
                           A    61    .value 4
                           A    62    .class 8
                           A    63    .type 12
                           A    64    .type 0
                           A    65    .endef
                           A    66    .define "field_width"
                           A    67    .value 5
                           A    68    .class 8
                           A    69    .type 2
                           A    70    .type 0
                           A    71    .endef
                           A    72    .define "precision"
                           A    73    .value 6
                           A    74    .class 8
                           A    75    .type 2
                           A    76    .type 0
                           A    77    .endef
                           A    78    .define "set_begin"
                           A    79    .value 7
                           A    80    .class 8
                           A    81    .type 140
                           A    82    .type 0
                           A    83    .endef
                           A    84    .define "set_end"
                           A    85    .value 9
                           A    86    .class 8
                           A    87    .type 140
                           A    88    .type 0
                           A    89    .endef
                           A    90    .define "pad_whole"
                           A    91    .value 11
                           A    92    .class 8
                           A    93    .type 12
                           A    94    .type 0
                           A    95    .endef
                           A    96    .define "pad_pre_fract"
                           A    97    .value 12
                           A    98    .class 8
                           A    99    .type 12
                           A   100    .type 0
                           A   101    .endef
                           A   102    .define "pad_post_fract"
                           A   103    .value 13
                           A   104    .class 8
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   3


PC     Object              I  Line    Source led.src
                           A   105    .type 12
                           A   106    .type 0
                           A   107    .endef
                           A   108    .define "pad_at"
                           A   109    .value 14
                           A   110    .class 8
                           A   111    .type 140
                           A   112    .type 0
                           A   113    .endef
                           A   114    .endrec "fmt_type"
                           A   115    .begrec "flt_info",12
                           A   116    .define "flags"
                           A   117    .value 0
                           A   118    .class 8
                           A   119    .type 12
                           A   120    .type 0
                           A   121    .endef
                           A   122    .define "exp"
                           A   123    .value 1
                           A   124    .class 8
                           A   125    .type 2
                           A   126    .type 0
                           A   127    .endef
                           A   128    .define "digits"
                           A   129    .value 2
                           A   130    .class 8
                           A   131    .dim 10
                           A   132    .type 108
                           A   133    .type 0
                           A   134    .endef
                           A   135    .endrec "flt_info"
                           A   136    ;    1	#include "LED.h"
                           A   137    ;    2	#include "LED_interrupts.h"
                           A   138    ;    3	
                           A   139    ;    4	#include <zneo.h>
                           A   140    ;    5	#include <stdlib.h>
                           A   141    ;    6	#include <stdio.h>
                           A   142    ;    7	#include <string.h>
                           A   143    ;    8	
                           A   144    ;    9	#define MAX_DIGITS 16  //Max digits for number displayed on LED
                           A   145    ;   10	
                           A   146    ;   11	extern unsigned char *led_msg;
                           A   147    ;   12	extern size_t msg_size;
                           A   148    ;   13	
                           A   149    ;   14	extern unsigned int msg_pos;
                           A   150    ;   15	extern unsigned int row_pos;
                           A   151    ;   16	extern unsigned int led_state;
                           A   152    ;   17	extern unsigned int uptime_state;
                           A   153    ;   18	
                           A   154    ;   19	extern float timer_cutoff;
                           A   155    ;   20	
                           A   156    ;   21	void led_set_text(const unsigned char *msg)
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   4


PC     Object              I  Line    Source led.src
                           A   157    ;   22	{
00000000                   A   158    _led_set_text:
                           A   159    .define "_led_set_text"
                           A   160    .value _led_set_text
                           A   161    .class 2
                           A   162    .type 65
                           A   163    .type 0
                           A   164    .endef
                           A   165    .begfunc "led_set_text",22,"_led_set_text"
00000000 0800              A   166    	LINK	#0
00000002 0580              A   167    	PUSHMHI	#1
                           A   168    .line 22
00000004 4418              A   169    	LD	R8,R1
                           A   170    .define "msg"
                           A   171    .class 17
                           A   172    .reg 9
                           A   173    .type 140
                           A   174    .type 0
                           A   175    .endef
                           A   176    ;   23		if(led_msg != NULL) {
                           A   177    .line 23
00000006 ADA5 0000         A   178    	CPZ.W	_led_msg:RAM
0000000A E6 04             A   179    	JP	EQ,_1_L_1
                           A   180    ;   24			free(led_msg);
                           A   181    .line 24
0000000C 0331 0000         A   182    	LD.SW	R1,_led_msg:RAM
00000010 F1 FFFFF6         A   183    	CALL	_free
                           A   184    ;   25		}
00000014                   A   185    _1_L_1:
                           A   186    .line 25
                           A   187    ;   26	
                           A   188    ;   27		msg_size = strlen(msg);
                           A   189    .line 27
00000014 4481              A   190    	LD	R1,R8
00000016 F1 FFFFF3         A   191    	CALL	_strlen
0000001A 0370 0000         A   192    	LD	_msg_size:RAM,R0
                           A   193    ;   28		led_msg = malloc(sizeof(*led_msg) * (msg_size + 2));	//+2 for space pad and null ter
                           A   194    .line 28
0000001E 0341 0000         A   195    	LD	R1,_msg_size:RAM
00000022 8102              A   196    	ADD	R1,#2
00000024 F1 FFFFEC         A   197    	CALL	_malloc
00000028 0360 0000         A   198    	LD.W	_led_msg:RAM,R0
                           A   199    ;   29		if(!led_msg) {
                           A   200    .line 29
0000002C ADA5 0000         A   201    	CPZ.W	_led_msg:RAM
00000030 EE 03             A   202    	JP	NE,_1_L_4
                           A   203    ;   30			msg_size = 0;
                           A   204    .line 30
00000032 ADA8 0000         A   205    	CLR	_msg_size:RAM
                           A   206    ;   31		}
                           A   207    ;   32		else {
                           A   208    .line 32
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   5


PC     Object              I  Line    Source led.src
00000036 C013              A   209    	JP	_1_L_5
00000038                   A   210    _1_L_4:
                           A   211    ;   33			memcpy(led_msg, msg, msg_size);
                           A   212    .line 33
00000038 0331 0000         A   213    	LD.SW	R1,_led_msg:RAM
0000003C 4482              A   214    	LD	R2,R8
0000003E 0343 0000         A   215    	LD	R3,_msg_size:RAM
00000042 F1 FFFFDD         A   216    	CALL	_memcpy
                           A   217    ;   34	
                           A   218    ;   35			//space pads the wrap-around
                           A   219    ;   36			if(msg_size > 4) {
                           A   220    .line 36
00000046 3004              A   221    	LD	R0,#4
00000048 7570 0000         A   222    	CP	_msg_size:RAM,R0
0000004C E3 08             A   223    	JP	ULE,_1_L_5
                           A   224    ;   37				led_msg[msg_size] = ' ';
                           A   225    .line 37
0000004E 0330 0002         A   226    	LD.SW	R0,_msg_size+2:RAM
00000052 7030 0000         A   227    	ADD.SW	R0,_led_msg:RAM
00000056 09C0 0020         A   228    	LD.B	(R0),#32
                           A   229    ;   38				++msg_size;
                           A   230    .line 38
0000005A ADAA 0000         A   231    	INC	_msg_size:RAM
                           A   232    ;   39			}
                           A   233    ;   40		}
0000005E                   A   234    _1_L_5:
                           A   235    .line 40
                           A   236    ;   41		led_msg[msg_size] = '\0';
                           A   237    .line 41
0000005E 0330 0002         A   238    	LD.SW	R0,_msg_size+2:RAM
00000062 7030 0000         A   239    	ADD.SW	R0,_led_msg:RAM
00000066 AC00              A   240    	CLR.B	(R0)
                           A   241    ;   42	
                           A   242    ;   43		msg_pos = 0;
                           A   243    .line 43
00000068 ADA8 0000         A   244    	CLR	_msg_pos:RAM
                           A   245    ;   44		row_pos = 0;
                           A   246    .line 44
0000006C ADA8 0000         A   247    	CLR	_row_pos:RAM
                           A   248    ;   45	}
                           A   249    .line 45
00000070 0701              A   250    	POPMHI	#1
00000072 0001              A   251    	UNLINK	
00000074 FFFC              A   252    	RET	
                           A   253    
                           A   254    
                           A   255    ;**************************** _led_set_text ***************************
                           A   256    ;Name                         Addr/Register   Size   Type
                           A   257    ;_row_pos                            IMPORT      4   variable
                           A   258    ;_msg_pos                            IMPORT      4   variable
                           A   259    ;_memcpy                             IMPORT  -----   function
                           A   260    ;_malloc                             IMPORT  -----   function
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   6


PC     Object              I  Line    Source led.src
                           A   261    ;_msg_size                           IMPORT      4   variable
                           A   262    ;_strlen                             IMPORT  -----   function
                           A   263    ;_free                               IMPORT  -----   function
                           A   264    ;_led_msg                            IMPORT      2   variable
                           A   265    ;msg                                     R8      2   parameter
                           A   266    
                           A   267    
                           A   268    ; Aggregate Stack Size: 0 (words)
                           A   269    
                           A   270    
                           A   271    .endfunc "led_set_text",45,"_led_set_text"
                           A   272    ;   46	
                           A   273    ;   47	void led_display_text(const unsigned char *msg)
                           A   274    ;   48	{
00000076                   A   275    _led_display_text:
                           A   276    .define "_led_display_text"
                           A   277    .value _led_display_text
                           A   278    .class 2
                           A   279    .type 65
                           A   280    .type 0
                           A   281    .endef
                           A   282    .begfunc "led_display_text",48,"_led_display_text"
00000076 0800              A   283    	LINK	#0
00000078 0580              A   284    	PUSHMHI	#1
                           A   285    .line 48
0000007A 4418              A   286    	LD	R8,R1
                           A   287    .define "msg"
                           A   288    .class 17
                           A   289    .reg 9
                           A   290    .type 140
                           A   291    .type 0
                           A   292    .endef
                           A   293    ;   49		led_state = LED_TEXT;
                           A   294    .line 49
0000007C ADA8 0000         A   295    	CLR	_led_state:RAM
                           A   296    ;   50		led_set_timer_cutoff(SCROLL_CUTOFF);
                           A   297    .line 50
00000080 4521 3ECCCCCD     A   298    	LD	R1,#1053609165
00000086 D005              A   299    	CALL	_led_set_timer_cutoff
                           A   300    ;   51	
                           A   301    ;   52		led_set_text(msg);
                           A   302    .line 52
00000088 4481              A   303    	LD	R1,R8
0000008A DFBA              A   304    	CALL	_led_set_text
                           A   305    ;   53	}
                           A   306    .line 53
0000008C 0701              A   307    	POPMHI	#1
0000008E 0001              A   308    	UNLINK	
00000090 FFFC              A   309    	RET	
                           A   310    
                           A   311    
                           A   312    ;**************************** _led_display_text ***************************
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   7


PC     Object              I  Line    Source led.src
                           A   313    ;Name                         Addr/Register   Size   Type
                           A   314    ;_led_set_text                       IMPORT  -----   function
                           A   315    ;_led_set_timer_cutoff               IMPORT  -----   function
                           A   316    ;_led_state                          IMPORT      4   variable
                           A   317    ;msg                                     R8      2   parameter
                           A   318    
                           A   319    
                           A   320    ; Aggregate Stack Size: 0 (words)
                           A   321    
                           A   322    
                           A   323    .endfunc "led_display_text",53,"_led_display_text"
                           A   324    ;   54	
                           A   325    ;   55	void led_set_timer_cutoff(float seconds)
                           A   326    ;   56	{
00000092                   A   327    _led_set_timer_cutoff:
                           A   328    .define "_led_set_timer_cutoff"
                           A   329    .value _led_set_timer_cutoff
                           A   330    .class 2
                           A   331    .type 65
                           A   332    .type 0
                           A   333    .endef
                           A   334    .begfunc "led_set_timer_cutoff",56,"_led_set_timer_cutoff"
                           A   335    .line 56
                           A   336    .define "seconds"
                           A   337    .class 17
                           A   338    .reg 2
                           A   339    .type 6
                           A   340    .type 0
                           A   341    .endef
00000092 0800              A   342    	LINK	#0
                           A   343    ;   57		timer_cutoff = seconds;
                           A   344    .line 57
00000094 0371 0000         A   345    	LD	_timer_cutoff:RAM,R1
                           A   346    ;   58	}
                           A   347    .line 58
00000098 0001              A   348    	UNLINK	
0000009A FFFC              A   349    	RET	
                           A   350    
                           A   351    
                           A   352    ;**************************** _led_set_timer_cutoff ***************************
                           A   353    ;Name                         Addr/Register   Size   Type
                           A   354    ;_timer_cutoff                       IMPORT      4   variable
                           A   355    ;seconds                                 R1      4   parameter
                           A   356    
                           A   357    
                           A   358    ; Aggregate Stack Size: 0 (words)
                           A   359    
                           A   360    
                           A   361    .endfunc "led_set_timer_cutoff",58,"_led_set_timer_cutoff"
                           A   362    ;   59	
                           A   363    ;   60	void led_display_uptime_seconds(void)
                           A   364    ;   61	{
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   8


PC     Object              I  Line    Source led.src
0000009C                   A   365    _led_display_uptime_seconds:
                           A   366    .define "_led_display_uptime_seconds"
                           A   367    .value _led_display_uptime_seconds
                           A   368    .class 2
                           A   369    .type 65
                           A   370    .type 0
                           A   371    .endef
                           A   372    .begfunc "led_display_uptime_seconds",61,"_led_display_uptime_seconds"
0000009C 0800              A   373    	LINK	#0
                           A   374    ;   62		led_set_timer_cutoff(SECOND_CUTOFF);
                           A   375    .line 62
0000009E 4521 3F800000     A   376    	LD	R1,#1065353216
000000A4 DFF6              A   377    	CALL	_led_set_timer_cutoff
                           A   378    ;   63		led_state = LED_UPTIME_S;
                           A   379    .line 63
000000A6 3001              A   380    	LD	R0,#1
000000A8 0370 0000         A   381    	LD	_led_state:RAM,R0
                           A   382    ;   64		uptime_state = UPTIME_DEC;
                           A   383    .line 64
000000AC ADA8 0000         A   384    	CLR	_uptime_state:RAM
                           A   385    ;   65	}
                           A   386    .line 65
000000B0 0001              A   387    	UNLINK	
000000B2 FFFC              A   388    	RET	
                           A   389    
                           A   390    
                           A   391    ;**************************** _led_display_uptime_seconds ***************************
                           A   392    ;Name                         Addr/Register   Size   Type
                           A   393    ;_uptime_state                       IMPORT      4   variable
                           A   394    ;_led_state                          IMPORT      4   variable
                           A   395    ;_led_set_timer_cutoff               IMPORT  -----   function
                           A   396    
                           A   397    
                           A   398    ; Aggregate Stack Size: 0 (words)
                           A   399    
                           A   400    
                           A   401    .endfunc "led_display_uptime_seconds",65,"_led_display_uptime_seconds"
                           A   402    ;   66	
                           A   403    ;   67	void led_display_uptime_ms(void)
                           A   404    ;   68	{
000000B4                   A   405    _led_display_uptime_ms:
                           A   406    .define "_led_display_uptime_ms"
                           A   407    .value _led_display_uptime_ms
                           A   408    .class 2
                           A   409    .type 65
                           A   410    .type 0
                           A   411    .endef
                           A   412    .begfunc "led_display_uptime_ms",68,"_led_display_uptime_ms"
000000B4 0800              A   413    	LINK	#0
                           A   414    ;   69		led_set_timer_cutoff(MS_CUTOFF);
                           A   415    .line 69
000000B6 4521 3C656042     A   416    	LD	R1,#1013276738
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:   9


PC     Object              I  Line    Source led.src
000000BC DFEA              A   417    	CALL	_led_set_timer_cutoff
                           A   418    ;   70		led_state = LED_UPTIME_MS;
                           A   419    .line 70
000000BE 3002              A   420    	LD	R0,#2
000000C0 0370 0000         A   421    	LD	_led_state:RAM,R0
                           A   422    ;   71		uptime_state = UPTIME_DEC;
                           A   423    .line 71
000000C4 ADA8 0000         A   424    	CLR	_uptime_state:RAM
                           A   425    ;   72	}
                           A   426    .line 72
000000C8 0001              A   427    	UNLINK	
000000CA FFFC              A   428    	RET	
                           A   429    
                           A   430    
                           A   431    ;**************************** _led_display_uptime_ms ***************************
                           A   432    ;Name                         Addr/Register   Size   Type
                           A   433    ;_uptime_state                       IMPORT      4   variable
                           A   434    ;_led_state                          IMPORT      4   variable
                           A   435    ;_led_set_timer_cutoff               IMPORT  -----   function
                           A   436    
                           A   437    
                           A   438    ; Aggregate Stack Size: 0 (words)
                           A   439    
                           A   440    
                           A   441    .endfunc "led_display_uptime_ms",72,"_led_display_uptime_ms"
                           A   442    ;   73	
                           A   443    ;   74	void led_display_uptime_seconds_hex(void)
                           A   444    ;   75	{
000000CC                   A   445    _led_display_uptime_seconds_hex:
                           A   446    .define "_led_display_uptime_seconds_hex"
                           A   447    .value _led_display_uptime_seconds_hex
                           A   448    .class 2
                           A   449    .type 65
                           A   450    .type 0
                           A   451    .endef
                           A   452    .begfunc "led_display_uptime_seconds_hex",75,"_led_display_uptime_seconds_hex"
000000CC 0800              A   453    	LINK	#0
                           A   454    ;   76		led_set_timer_cutoff(SECOND_CUTOFF);
                           A   455    .line 76
000000CE 4521 3F800000     A   456    	LD	R1,#1065353216
000000D4 DFDE              A   457    	CALL	_led_set_timer_cutoff
                           A   458    ;   77		led_state = LED_UPTIME_S;
                           A   459    .line 77
000000D6 3001              A   460    	LD	R0,#1
000000D8 0370 0000         A   461    	LD	_led_state:RAM,R0
                           A   462    ;   78		uptime_state = UPTIME_HEX;
                           A   463    .line 78
000000DC 3001              A   464    	LD	R0,#1
000000DE 0370 0000         A   465    	LD	_uptime_state:RAM,R0
                           A   466    ;   79	}
                           A   467    .line 79
000000E2 0001              A   468    	UNLINK	
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  10


PC     Object              I  Line    Source led.src
000000E4 FFFC              A   469    	RET	
                           A   470    
                           A   471    
                           A   472    ;**************************** _led_display_uptime_seconds_hex ***************************
                           A   473    ;Name                         Addr/Register   Size   Type
                           A   474    ;_uptime_state                       IMPORT      4   variable
                           A   475    ;_led_state                          IMPORT      4   variable
                           A   476    ;_led_set_timer_cutoff               IMPORT  -----   function
                           A   477    
                           A   478    
                           A   479    ; Aggregate Stack Size: 0 (words)
                           A   480    
                           A   481    
                           A   482    .endfunc "led_display_uptime_seconds_hex",79,"_led_display_uptime_seconds_hex"
                           A   483    ;   80	
                           A   484    ;   81	void led_display_uptime_ms_hex(void)
                           A   485    ;   82	{
000000E6                   A   486    _led_display_uptime_ms_hex:
                           A   487    .define "_led_display_uptime_ms_hex"
                           A   488    .value _led_display_uptime_ms_hex
                           A   489    .class 2
                           A   490    .type 65
                           A   491    .type 0
                           A   492    .endef
                           A   493    .begfunc "led_display_uptime_ms_hex",82,"_led_display_uptime_ms_hex"
000000E6 0800              A   494    	LINK	#0
                           A   495    ;   83		led_set_timer_cutoff(MS_CUTOFF);
                           A   496    .line 83
000000E8 4521 3C656042     A   497    	LD	R1,#1013276738
000000EE DFD1              A   498    	CALL	_led_set_timer_cutoff
                           A   499    ;   84		led_state = LED_UPTIME_MS;
                           A   500    .line 84
000000F0 3002              A   501    	LD	R0,#2
000000F2 0370 0000         A   502    	LD	_led_state:RAM,R0
                           A   503    ;   85		uptime_state = UPTIME_HEX;
                           A   504    .line 85
000000F6 3001              A   505    	LD	R0,#1
000000F8 0370 0000         A   506    	LD	_uptime_state:RAM,R0
                           A   507    ;   86	}
                           A   508    .line 86
000000FC 0001              A   509    	UNLINK	
000000FE FFFC              A   510    	RET	
                           A   511    
                           A   512    
                           A   513    ;**************************** _led_display_uptime_ms_hex ***************************
                           A   514    ;Name                         Addr/Register   Size   Type
                           A   515    ;_uptime_state                       IMPORT      4   variable
                           A   516    ;_led_state                          IMPORT      4   variable
                           A   517    ;_led_set_timer_cutoff               IMPORT  -----   function
                           A   518    
                           A   519    
                           A   520    ; Aggregate Stack Size: 0 (words)
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  11


PC     Object              I  Line    Source led.src
                           A   521    
                           A   522    
                           A   523    .endfunc "led_display_uptime_ms_hex",86,"_led_display_uptime_ms_hex"
                           A   524    ;   87	
                           A   525    ;   88	void led_display_double(double value)
                           A   526    ;   89	{
00000100                   A   527    _led_display_double:
                           A   528    .define "_led_display_double"
                           A   529    .value _led_display_double
                           A   530    .class 2
                           A   531    .type 65
                           A   532    .type 0
                           A   533    .endef
                           A   534    .begfunc "led_display_double",89,"_led_display_double"
00000100 0800              A   535    	LINK	#0
00000102 0580              A   536    	PUSHMHI	#1
                           A   537    .line 89
00000104 4418              A   538    	LD	R8,R1
                           A   539    .define "value"
                           A   540    .class 17
                           A   541    .reg 9
                           A   542    .type 6
                           A   543    .type 0
                           A   544    .endef
                           A   545    ;   90		led_state = LED_TEXT;
                           A   546    .line 90
00000106 ADA8 0000         A   547    	CLR	_led_state:RAM
                           A   548    ;   91		led_set_timer_cutoff(SCROLL_CUTOFF);
                           A   549    .line 91
0000010A 4521 3ECCCCCD     A   550    	LD	R1,#1053609165
00000110 DFC0              A   551    	CALL	_led_set_timer_cutoff
                           A   552    ;   92	
                           A   553    ;   93		led_set_double(value);
                           A   554    .line 93
00000112 4481              A   555    	LD	R1,R8
00000114 D003              A   556    	CALL	_led_set_double
                           A   557    ;   94	}
                           A   558    .line 94
00000116 0701              A   559    	POPMHI	#1
00000118 0001              A   560    	UNLINK	
0000011A FFFC              A   561    	RET	
                           A   562    
                           A   563    
                           A   564    ;**************************** _led_display_double ***************************
                           A   565    ;Name                         Addr/Register   Size   Type
                           A   566    ;_led_set_double                     IMPORT  -----   function
                           A   567    ;_led_set_timer_cutoff               IMPORT  -----   function
                           A   568    ;_led_state                          IMPORT      4   variable
                           A   569    ;value                                   R8      4   parameter
                           A   570    
                           A   571    
                           A   572    ; Aggregate Stack Size: 0 (words)
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  12


PC     Object              I  Line    Source led.src
                           A   573    
                           A   574    
                           A   575    .endfunc "led_display_double",94,"_led_display_double"
                           A   576    ;   95	
                           A   577    ;   96	void led_set_double(double value)
                           A   578    ;   97	{
0000011C                   A   579    _led_set_double:
                           A   580    .define "_led_set_double"
                           A   581    .value _led_set_double
                           A   582    .class 2
                           A   583    .type 65
                           A   584    .type 0
                           A   585    .endef
                           A   586    .begfunc "led_set_double",97,"_led_set_double"
                           A   587    .line 97
                           A   588    .define "value"
                           A   589    .class 17
                           A   590    .reg -1
                           A   591    .type 6
                           A   592    .type 0
                           A   593    .endef
                           A   594    .define "num_msg"
                           A   595    .class 1
                           A   596    .value -16
                           A   597    .dim 16
                           A   598    .type 108
                           A   599    .type 0
                           A   600    .endef
0000011C 0810              A   601    	LINK	#16
                           A   602    ;   98		unsigned char num_msg[MAX_DIGITS];
                           A   603    ;   99	
                           A   604    ;  100		sprintf(num_msg, "%f", value);
                           A   605    .line 100
0000011E 4F00              A   606    	LEA	R0,-16(R14)
00000120 0360 0000         A   607    	LD.W	___print_out:RAM,R0
00000124 3006              A   608    	LD	R0,#6
00000126 0350 0006         A   609    	LD.B	___print_fmt+6:RAM,R0
0000012A 3066              A   610    	LD	R0,#102
0000012C 0350 0004         A   611    	LD.B	___print_fmt+4:RAM,R0
00000130 F1 FFFF66         A   612    	CALL	__u_dtof
00000134 3100              A   613    	LD	R1,#0
00000136 F1 FFFF63         A   614    	CALL	___print_sputch
                           A   615    ;  101	
                           A   616    ;  102		led_set_text(num_msg);
                           A   617    .line 102
0000013A 4F01              A   618    	LEA	R1,-16(R14)
0000013C DF61              A   619    	CALL	_led_set_text
                           A   620    ;  103	}
                           A   621    .line 103
0000013E 0001              A   622    	UNLINK	
00000140 FFFC              A   623    	RET	
                           A   624    
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  13


PC     Object              I  Line    Source led.src
                           A   625    
                           A   626    ;**************************** _led_set_double ***************************
                           A   627    ;Name                         Addr/Register   Size   Type
                           A   628    ;_led_set_text                       IMPORT  -----   function
                           A   629    ;___print_sputch                     IMPORT  -----   function
                           A   630    ;__u_dtof                            IMPORT  -----   function
                           A   631    ;___print_fmt                        IMPORT     16   variable
                           A   632    ;___print_out                        IMPORT      2   variable
                           A   633    ;num_msg                             R14-16     16   variable
                           A   634    ;value                          <optimized>      4   parameter
                           A   635    
                           A   636    
                           A   637    ; Aggregate Stack Size: -16 (words)
                           A   638    
                           A   639    
                           A   640    .endfunc "led_set_double",103,"_led_set_double"
                           A   641    ;  104	
                           A   642    ;  105	
                           A   643    ;  106	void led_display_int(int value)
                           A   644    ;  107	{
00000142                   A   645    _led_display_int:
                           A   646    .define "_led_display_int"
                           A   647    .value _led_display_int
                           A   648    .class 2
                           A   649    .type 65
                           A   650    .type 0
                           A   651    .endef
                           A   652    .begfunc "led_display_int",107,"_led_display_int"
00000142 0800              A   653    	LINK	#0
00000144 0580              A   654    	PUSHMHI	#1
                           A   655    .line 107
00000146 4418              A   656    	LD	R8,R1
                           A   657    .define "value"
                           A   658    .class 17
                           A   659    .reg 9
                           A   660    .type 5
                           A   661    .type 0
                           A   662    .endef
                           A   663    ;  108		led_state = LED_TEXT;
                           A   664    .line 108
00000148 ADA8 0000         A   665    	CLR	_led_state:RAM
                           A   666    ;  109		led_set_timer_cutoff(SCROLL_CUTOFF);
                           A   667    .line 109
0000014C 4521 3ECCCCCD     A   668    	LD	R1,#1053609165
00000152 DF9F              A   669    	CALL	_led_set_timer_cutoff
                           A   670    ;  110	
                           A   671    ;  111		led_set_int(value);
                           A   672    .line 111
00000154 4481              A   673    	LD	R1,R8
00000156 D003              A   674    	CALL	_led_set_int
                           A   675    ;  112	}
                           A   676    .line 112
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  14


PC     Object              I  Line    Source led.src
00000158 0701              A   677    	POPMHI	#1
0000015A 0001              A   678    	UNLINK	
0000015C FFFC              A   679    	RET	
                           A   680    
                           A   681    
                           A   682    ;**************************** _led_display_int ***************************
                           A   683    ;Name                         Addr/Register   Size   Type
                           A   684    ;_led_set_int                        IMPORT  -----   function
                           A   685    ;_led_set_timer_cutoff               IMPORT  -----   function
                           A   686    ;_led_state                          IMPORT      4   variable
                           A   687    ;value                                   R8      4   parameter
                           A   688    
                           A   689    
                           A   690    ; Aggregate Stack Size: 0 (words)
                           A   691    
                           A   692    
                           A   693    .endfunc "led_display_int",112,"_led_display_int"
                           A   694    ;  113	
                           A   695    ;  114	void led_set_int(int value)
                           A   696    ;  115	{
0000015E                   A   697    _led_set_int:
                           A   698    .define "_led_set_int"
                           A   699    .value _led_set_int
                           A   700    .class 2
                           A   701    .type 65
                           A   702    .type 0
                           A   703    .endef
                           A   704    .begfunc "led_set_int",115,"_led_set_int"
                           A   705    .line 115
                           A   706    .define "value"
                           A   707    .class 17
                           A   708    .reg -1
                           A   709    .type 5
                           A   710    .type 0
                           A   711    .endef
                           A   712    .define "num_msg"
                           A   713    .class 1
                           A   714    .value -16
                           A   715    .dim 16
                           A   716    .type 108
                           A   717    .type 0
                           A   718    .endef
0000015E 0810              A   719    	LINK	#16
                           A   720    ;  116		unsigned char num_msg[MAX_DIGITS];
                           A   721    ;  117	
                           A   722    ;  118		sprintf(num_msg, "%d", value);
                           A   723    .line 118
00000160 4F00              A   724    	LEA	R0,-16(R14)
00000162 0360 0000         A   725    	LD.W	___print_out:RAM,R0
00000166 F1 FFFF4B         A   726    	CALL	__u_stoa
0000016A 3100              A   727    	LD	R1,#0
0000016C F1 FFFF48         A   728    	CALL	___print_sputch
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  15


PC     Object              I  Line    Source led.src
                           A   729    ;  119	
                           A   730    ;  120		led_set_text(num_msg);
                           A   731    .line 120
00000170 4F01              A   732    	LEA	R1,-16(R14)
00000172 DF46              A   733    	CALL	_led_set_text
                           A   734    ;  121	}
                           A   735    .line 121
00000174 0001              A   736    	UNLINK	
00000176 FFFC              A   737    	RET	
                           A   738    
                           A   739    
                           A   740    ;**************************** _led_set_int ***************************
                           A   741    ;Name                         Addr/Register   Size   Type
                           A   742    ;_led_set_text                       IMPORT  -----   function
                           A   743    ;___print_sputch                     IMPORT  -----   function
                           A   744    ;__u_stoa                            IMPORT  -----   function
                           A   745    ;___print_out                        IMPORT      2   variable
                           A   746    ;num_msg                             R14-16     16   variable
                           A   747    ;value                          <optimized>      4   parameter
                           A   748    
                           A   749    
                           A   750    ; Aggregate Stack Size: -16 (words)
                           A   751    
                           A   752    
                           A   753    .endfunc "led_set_int",121,"_led_set_int"
                           A   754    ;  122	
                           A   755    ;  123	void led_display_int_hex(int value)
                           A   756    ;  124	{
00000178                   A   757    _led_display_int_hex:
                           A   758    .define "_led_display_int_hex"
                           A   759    .value _led_display_int_hex
                           A   760    .class 2
                           A   761    .type 65
                           A   762    .type 0
                           A   763    .endef
                           A   764    .begfunc "led_display_int_hex",124,"_led_display_int_hex"
00000178 0800              A   765    	LINK	#0
0000017A 0580              A   766    	PUSHMHI	#1
                           A   767    .line 124
0000017C 4418              A   768    	LD	R8,R1
                           A   769    .define "value"
                           A   770    .class 17
                           A   771    .reg 9
                           A   772    .type 5
                           A   773    .type 0
                           A   774    .endef
                           A   775    ;  125		led_state = LED_TEXT;
                           A   776    .line 125
0000017E ADA8 0000         A   777    	CLR	_led_state:RAM
                           A   778    ;  126		led_set_timer_cutoff(SCROLL_CUTOFF);
                           A   779    .line 126
00000182 4521 3ECCCCCD     A   780    	LD	R1,#1053609165
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  16


PC     Object              I  Line    Source led.src
00000188 DF84              A   781    	CALL	_led_set_timer_cutoff
                           A   782    ;  127	
                           A   783    ;  128		led_set_int_hex(value);
                           A   784    .line 128
0000018A 4481              A   785    	LD	R1,R8
0000018C D003              A   786    	CALL	_led_set_int_hex
                           A   787    ;  129	}
                           A   788    .line 129
0000018E 0701              A   789    	POPMHI	#1
00000190 0001              A   790    	UNLINK	
00000192 FFFC              A   791    	RET	
                           A   792    
                           A   793    
                           A   794    ;**************************** _led_display_int_hex ***************************
                           A   795    ;Name                         Addr/Register   Size   Type
                           A   796    ;_led_set_int_hex                    IMPORT  -----   function
                           A   797    ;_led_set_timer_cutoff               IMPORT  -----   function
                           A   798    ;_led_state                          IMPORT      4   variable
                           A   799    ;value                                   R8      4   parameter
                           A   800    
                           A   801    
                           A   802    ; Aggregate Stack Size: 0 (words)
                           A   803    
                           A   804    
                           A   805    .endfunc "led_display_int_hex",129,"_led_display_int_hex"
                           A   806    ;  130	
                           A   807    ;  131	void led_set_int_hex(int value)
                           A   808    ;  132	{
00000194                   A   809    _led_set_int_hex:
                           A   810    .define "_led_set_int_hex"
                           A   811    .value _led_set_int_hex
                           A   812    .class 2
                           A   813    .type 65
                           A   814    .type 0
                           A   815    .endef
                           A   816    .begfunc "led_set_int_hex",132,"_led_set_int_hex"
                           A   817    .line 132
                           A   818    .define "value"
                           A   819    .class 17
                           A   820    .reg -1
                           A   821    .type 5
                           A   822    .type 0
                           A   823    .endef
                           A   824    .define "num_msg"
                           A   825    .class 1
                           A   826    .value -16
                           A   827    .dim 16
                           A   828    .type 108
                           A   829    .type 0
                           A   830    .endef
00000194 0810              A   831    	LINK	#16
                           A   832    ;  133		unsigned char num_msg[MAX_DIGITS];
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  17


PC     Object              I  Line    Source led.src
                           A   833    ;  134	
                           A   834    ;  135		sprintf(num_msg, "%X", value);
                           A   835    .line 135
00000196 4F00              A   836    	LEA	R0,-16(R14)
00000198 0360 0000         A   837    	LD.W	___print_out:RAM,R0
0000019C 3020              A   838    	LD	R0,#32
0000019E 0350 0001         A   839    	LD.B	___print_fmt+1:RAM,R0
000001A2 3078              A   840    	LD	R0,#120
000001A4 0350 0004         A   841    	LD.B	___print_fmt+4:RAM,R0
000001A8 F1 FFFF2A         A   842    	CALL	__u_ustoa
000001AC 3100              A   843    	LD	R1,#0
000001AE F1 FFFF27         A   844    	CALL	___print_sputch
                           A   845    ;  136	
                           A   846    ;  137		led_set_text(num_msg);
                           A   847    .line 137
000001B2 4F01              A   848    	LEA	R1,-16(R14)
000001B4 DF25              A   849    	CALL	_led_set_text
                           A   850    ;  138	}
                           A   851    .line 138
000001B6 0001              A   852    	UNLINK	
000001B8 FFFC              A   853    	RET	
                           A   854    
                           A   855    
                           A   856    ;**************************** _led_set_int_hex ***************************
                           A   857    ;Name                         Addr/Register   Size   Type
                           A   858    ;_led_set_text                       IMPORT  -----   function
                           A   859    ;___print_sputch                     IMPORT  -----   function
                           A   860    ;__u_ustoa                           IMPORT  -----   function
                           A   861    ;___print_fmt                        IMPORT     16   variable
                           A   862    ;___print_out                        IMPORT      2   variable
                           A   863    ;num_msg                             R14-16     16   variable
                           A   864    ;value                          <optimized>      4   parameter
                           A   865    
                           A   866    
                           A   867    ; Aggregate Stack Size: -16 (words)
                           A   868    
                           A   869    
                           A   870    .endfunc "led_set_int_hex",138,"_led_set_int_hex"
                           A   871    ;  139	
                           A   872    ;  140	void led_init(void) 
                           A   873    ;  141	{ 
000001BA                   A   874    _led_init:
                           A   875    .define "_led_init"
                           A   876    .value _led_init
                           A   877    .class 2
                           A   878    .type 65
                           A   879    .type 0
                           A   880    .endef
                           A   881    .begfunc "led_init",141,"_led_init"
000001BA 0800              A   882    	LINK	#0
                           A   883    ;  142	    PEDD = 0x00;	// data direction = outputs	
                           A   884    .line 142
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  18


PC     Object              I  Line    Source led.src
000001BC ADA0 E142         A   885    	CLR.B	57666:RAM
                           A   886    ;  143		PGDD = 0x00;
                           A   887    .line 143
000001C0 ADA0 E162         A   888    	CLR.B	57698:RAM
                           A   889    ;  144	
                           A   890    ;  145		init_led_timers();
                           A   891    .line 145
000001C4 F1 FFFF1C         A   892    	CALL	_init_led_timers
                           A   893    ;  146	}
                           A   894    .line 146
000001C8 0001              A   895    	UNLINK	
000001CA FFFC              A   896    	RET	
                           A   897    
                           A   898    
                           A   899    ;**************************** _led_init ***************************
                           A   900    ;Name                         Addr/Register   Size   Type
                           A   901    ;_init_led_timers                    IMPORT  -----   function
                           A   902    
                           A   903    
                           A   904    ; Aggregate Stack Size: 0 (words)
                           A   905    
                           A   906    
                           A   907    .endfunc "led_init",146,"_led_init"
                           A   908    	XREF _timer_cutoff:RAM
                           A   909    	XREF _uptime_state:RAM
                           A   910    	XREF _led_state:RAM
                           A   911    	XREF _row_pos:RAM
                           A   912    	XREF _msg_pos:RAM
                           A   913    	XREF _msg_size:RAM
                           A   914    	XREF _led_msg:RAM
                           A   915    	XREF _memcpy:EROM
                           A   916    	XREF _strlen:EROM
                           A   917    	XREF __u_dtof:EROM
                           A   918    	XREF __u_ustoa:EROM
                           A   919    	XREF __u_stoa:EROM
                           A   920    	XREF ___print_sputch:EROM
                           A   921    	XREF ___print_out:RAM
                           A   922    	XREF ___print_fmt:RAM
                           A   923    	XREF _malloc:EROM
                           A   924    	XREF _free:EROM
                           A   925    	XREF _init_led_timers:EROM
                           A   926    	XDEF _led_init
                           A   927    	XDEF _led_set_int_hex
                           A   928    	XDEF _led_display_int_hex
                           A   929    	XDEF _led_set_int
                           A   930    	XDEF _led_display_int
                           A   931    	XDEF _led_set_double
                           A   932    	XDEF _led_display_double
                           A   933    	XDEF _led_display_uptime_ms_hex
                           A   934    	XDEF _led_display_uptime_seconds_hex
                           A   935    	XDEF _led_display_uptime_ms
                           A   936    	XDEF _led_display_uptime_seconds
ZiLOG ZNEO Macro Assembler Version 1.10 (07022203)                                               15-Feb-11     21:07:31     page:  19


PC     Object              I  Line    Source led.src
                           A   937    	XDEF _led_set_timer_cutoff
                           A   938    	XDEF _led_display_text
                           A   939    	XDEF _led_set_text
                           A   940    	END


Errors: 0
Warnings: 0
Lines Assembled: 941
